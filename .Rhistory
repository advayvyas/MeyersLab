knitr::kable(texas_flu_vax, caption = "Flu Vaccination Coverage Estimates by County")
knitr::kable(texas_flu_vax, caption = "Flu Vaccination Coverage Estimates by County", col.names = c("County", "Corresponding Cities", "Coverage Rate"))
texas_flu_vax = data.frame(
county = unique(counties),
corresponding_cities = corresponding_cities,
coverage_rate = c(38.4, 41.4, 39.9, 42.5, 39.4, 38, 34.1)
)
knitr::kable(texas_flu_vax, caption = "Flu Vaccination Coverage Estimates by County", col.names = c("County", "Corresponding Cities", "Coverage Rate"))
texas_flu_vax = data.frame(
county = counties,
corresponding_cities = corresponding_cities,
coverage_rate = c(38.4, 41.4, 39.9, 42.5, 39.4, 38, 34.1)
)
texas_flu_vax = data.frame(
county = unique(counties),
corresponding_cities = corresponding_cities,
coverage_rate = c(38.4, 41.4, 39.9, 42.5, 39.4, 38, 34.1)
)
knitr::kable(texas_flu_vax, caption = "Flu Vaccination Coverage Estimates by County", col.names = c("County", "Corresponding Cities", "Coverage Rate"))
counties
unique(counties)
corresponding_cities_vax = c(
"Houston",           # Harris County
"San Antonio",       # Bexar County
"Dallas",            # Dallas County
"Austin",            # Travis County
"Fort Worth & Arlington", # Tarrant County
"El Paso",           # El Paso County
"Corpus Christi"     # Nueces County
)
texas_flu_vax = data.frame(
county = unique(counties),
corresponding_cities = corresponding_cities_vax,
coverage_rate = c(38.4, 41.4, 39.9, 42.5, 39.4, 38, 34.1)
)
knitr::kable(texas_flu_vax, caption = "Flu Vaccination Coverage Estimates by County", col.names = c("County", "Corresponding Cities", "Coverage Rate"))
texas_flu_vax = data.frame(
county = unique(counties),
corresponding_cities = corresponding_cities_vax,
coverage_rate = c(38.4, 41.4, 39.9, 42.5, 39.4, 38, 34.1)
) %>% arrange(desc(coverage_rate))
corresponding_cities_vax = c(
"Houston",           # Harris County
"San Antonio",       # Bexar County
"Dallas",            # Dallas County
"Austin",            # Travis County
"Fort Worth & Arlington", # Tarrant County
"El Paso",           # El Paso County
"Corpus Christi"     # Nueces County
)
texas_flu_vax = data.frame(
county = unique(counties),
corresponding_cities = corresponding_cities_vax,
coverage_rate = c(38.4, 41.4, 39.9, 42.5, 39.4, 38, 34.1)
) %>% arrange(desc(coverage_rate))
knitr::kable(texas_flu_vax, caption = "Flu Vaccination Coverage Estimates by County", col.names = c("County", "Corresponding Cities", "Coverage Rate"))
corresponding_cities_vax = c(
"Houston",           # Harris County
"San Antonio",       # Bexar County
"Dallas",            # Dallas County
"Austin",            # Travis County
"Fort Worth & Arlington", # Tarrant County
"El Paso",           # El Paso County
"Corpus Christi"     # Nueces County
)
texas_flu_vax = data.frame(
county = unique(counties),
corresponding_cities = corresponding_cities_vax,
coverage_rate = c(38.4, 41.4, 39.9, 42.5, 39.4, 38, 34.1)
) %>% arrange(desc(coverage_rate))
knitr::kable(texas_flu_vax, caption = "Flu Vaccination Coverage Estimates by County in 2022", col.names = c("County", "Corresponding Cities", "Coverage Rate"))
ggplot(city_trend_major, aes(x = quarter, y = patients_per_100k, group = PAT_City, color = PAT_City)) +
geom_line(linewidth = 1,) +
geom_point() +
labs(title = "Flu patients per 100,000 over time by city", x = "Quarter", y = "Patients per 100,000", color = "City") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(city_trend_major, aes(x = quarter, y = patients_per_100k, group = PAT_City, color = PAT_City)) +
geom_line(linewidth = 1,) +
geom_point() +
labs(title = "Flu patients per 100,000 over time by city", x = "Quarter", y = "Patients per 100,000", color = "City") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
regular = ggplot(city_trend_major, aes(x = quarter, y = total_patients, group = PAT_City)) +
geom_line(linewidth = 1.2, color = "blue") +
geom_point(color = "blue") +
labs(title = "Patients over time by city", x = "Quarter", y = "Flu patients", color = "City") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) + facet_wrap(~PAT_City, nrow = 8)
normalized = ggplot(city_trend_major, aes(x = quarter, y = patients_per_100k, group = PAT_City)) +
geom_line(linewidth = 1.2, color = "red") +
geom_point(color = "red") +
labs(title = "Patients per 100,000 over time by city", x = "Quarter", y = "Flu patients per 100,000", color = "City") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) + facet_wrap(~PAT_City, nrow = 8)
regular + normalized
regular = ggplot(city_trend_major, aes(x = quarter, y = total_patients, group = PAT_City)) +
geom_line(linewidth = 1.2, color = "blue") +
geom_point(color = "blue") +
labs(title = "Patients over time by city", x = "Quarter", y = "Flu patients", color = "City") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) + facet_wrap(~PAT_City, nrow = 8)
normalized = ggplot(city_trend_major, aes(x = quarter, y = patients_per_100k, group = PAT_City)) +
geom_line(linewidth = 1.2, color = "red") +
geom_point(color = "red") +
labs(title = "Patients per 100,000 over time by city", x = "Quarter", y = "Flu patients per 100,000", color = "City") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) + facet_wrap(~PAT_City, nrow = 8)
regular + normalized
ggplot(weather, aes(x=year, y=avg_temp, color = county)) + geom_line(linewidth = 1) + labs(title = "Average Temperature by Year by County", x = "Year", y = "Average Temperature (year)")
ggplot(weather, aes(x=year, y=avg_temp, color = county)) + geom_line(linewidth = 1) + labs(title = "Average Temperature by Year by County", x = "Year", y = "Average Temperature (year)") + geom_point()
ggplot(weather, aes(x=year, y=avg_temp, color = county)) + geom_line(linewidth = 1) + labs(title = "Average Temperature by Year by County", x = "Year", y = "Average Temperature (year)") + geom_point()
ggplot(weather, aes(x=year, y=avg_temp, color = county)) + geom_line(linewidth = 1) + labs(title = "Average Temperature by Year by County", x = "Year", y = "Average Temperature (year)") + geom_point()
knitr::opts_chunk$set(fig.height=8, fig.width=8, fig.align = "center", warning=FALSE, echo=FALSE, tidy=TRUE, tidy.opts=list(width.cutoff=60))
library(dplyr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(patchwork)
ggplot(city_trend_major, aes(x = quarter, y = patients_per_100k, group = PAT_City, color = PAT_City)) +
geom_line(linewidth = 1,) +
geom_point() +
labs(title = "Flu patients per 100,000 over time by city", x = "Quarter", y = "Patients per 100,000", color = "City") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
knitr::opts_chunk$set(fig.height=8, fig.width=8, fig.align = "center", warning=FALSE, echo=FALSE, tidy=TRUE, tidy.opts=list(width.cutoff=60))
library(dplyr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(patchwork)
facility = read.csv("../DSHS/thcic-ids_city_county_crosswalk.csv")
facility_filtered = facility %>%
group_by(THCIC_ID) %>%
filter(YEAR == max(YEAR)) %>%
ungroup()
TX_zip_zcta_pop_city = read.csv("../DSHS/TX_zip_zcta_pop_city.csv")
TX_zcta_pop_city = TX_zip_zcta_pop_city %>%
select(zcta, City, population) %>%
distinct() %>%
group_by(City) %>%
summarise(population = sum(population))
County = read.csv("../DSHS/county_fips_us.csv")
flu22_3 = read.csv("../DSHS/FLU_ALL_PAT_CAT_2022Q3.csv")
flu22_4 = read.csv("../DSHS/FLU_ALL_PAT_CAT_2022Q4.csv")
flu23_1 = read.csv("../DSHS/FLU_ALL_PAT_CAT_2023Q1.csv")
flu23_2 = read.csv("../DSHS/FLU_ALL_PAT_CAT_2023Q2.csv")
flu23_3 = read.csv("../DSHS/FLU_ALL_PAT_CAT_2023Q3.csv")
flu23_4 = read.csv("../DSHS/FLU_ALL_PAT_CAT_2023Q4.csv")
flu24_1 = read.csv("../DSHS/FLU_ALL_PAT_CAT_2024Q1.csv")
flu24_2 = read.csv("../DSHS/FLU_ALL_PAT_CAT_2024Q2.csv")
flu_all_pat_filter = function(flu1){
flu11 = flu1 %>%
select(THCIC_ID, PAT_STATE, PAT_ZIP, PAT_COUNTRY, PAT_COUNTY) %>%
mutate(PAT_ZIP = ifelse(nchar(PAT_ZIP) < 5 | grepl("\\D", PAT_ZIP), NA, PAT_ZIP)) %>%
mutate(
PAT_COUNTY_FIPS = str_pad(PAT_COUNTY, width = 3, side = "left", pad = "0"),
PAT_COUNTY_FIPS = paste0("48", PAT_COUNTY_FIPS)
) %>%
mutate(PAT_COUNTY_FIPS = as.integer(PAT_COUNTY_FIPS),
PAT_ZIP = as.integer(PAT_ZIP)) %>%
left_join(County, by = c("PAT_COUNTY_FIPS" = "FIPS")) %>%
rename(PAT_County = County) %>%
select(-State.Abbreviation, -State.Name, -FIPS_int, -PAT_COUNTRY) %>%
left_join(TX_zip_zcta_pop_city, by = c("PAT_ZIP" = "ZIP_CODE", "PAT_STATE" = "STATE")) %>%
rename(PAT_zcta = zcta,
PAT_City = City,
PAT_PO_NAME = PO_NAME,
PAT_population = population)
flu12 = flu11 %>%
left_join(facility_filtered, by = "THCIC_ID") %>%
select(-HOSP_NAME, -HOSP_NAME_clean) %>%
filter(!is.na(HOSP_CITY) & !is.na(PAT_City))
return(flu12)
}
flu22_3_prop = flu_all_pat_filter(flu22_3)
flu22_4_prop = flu_all_pat_filter(flu22_4)
flu23_1_prop = flu_all_pat_filter(flu23_1)
flu23_2_prop = flu_all_pat_filter(flu23_2)
flu23_3_prop = flu_all_pat_filter(flu23_3)
flu23_4_prop = flu_all_pat_filter(flu23_4)
flu24_1_prop = flu_all_pat_filter(flu24_1)
flu24_2_prop = flu_all_pat_filter(flu24_2)
# Add quarter tag and combine
flu22_3_prop$year = 2022
flu22_3_prop$quarter = "2022Q3"
flu22_4_prop$year = 2022
flu22_4_prop$quarter = "2022Q4"
flu23_1_prop$year = 2023
flu23_1_prop$quarter = "2023Q1"
flu23_2_prop$year = 2023
flu23_2_prop$quarter = "2023Q2"
flu23_3_prop$year = 2023
flu23_3_prop$quarter = "2023Q3"
flu23_4_prop$year = 2023
flu23_4_prop$quarter = "2023Q4"
flu24_1_prop$year = 2024
flu24_1_prop$quarter = "2024Q1"
flu24_2_prop$year = 2024
flu24_2_prop$quarter = "2024Q2"
flu24_1_prop$year = 2024
flu24_2_prop$quarter = "2024Q2"
flu_all_labeled = bind_rows(
flu22_3_prop, flu22_4_prop,
flu23_1_prop, flu23_2_prop,
flu23_3_prop, flu23_4_prop,
flu24_1_prop, flu24_2_prop
)
city_trend = flu_all_labeled %>%
filter(PAT_STATE == "TX") %>%
group_by(PAT_City, year, quarter) %>%
summarise(total_patients = n(), .groups = "drop")
# Focus on major cities
major_cities = c("Houston", "San Antonio", "Dallas", "Austin", "Fort Worth", "El Paso", "Arlington", "Corpus Christi")
pop_data_24 <- data.frame(
year = 2024,
City = c("Houston", "San Antonio", "Dallas", "Fort Worth", "Austin",
"El Paso", "Arlington", "Corpus Christi"),
population = c(2319119, 1513974, 1302753, 996756, 984567, 678859, 399825, 316105)
)
# gotta clean up this data
city_pop = read.csv("../texas_city_pop.csv")
city_pop = city_pop[c(3:1233), c(1, 3:6)]
names(city_pop) = as.character(city_pop[1, ])
names(city_pop)[1] = "City"
city_pop = city_pop[-1, ]
city_pop = city_pop[c(52, 270, 44, 237, 340, 972, 497, 376),]
city_pop$City = c("Austin", "Dallas", "Arlington", "Corpus Christi", "El Paso", "San Antonio", "Houston", "Fort Worth")
city_pop = city_pop %>%  mutate(across(2:5, ~ as.numeric(gsub("[^0-9.-]", "", .)))) %>% arrange(desc(1))
city_pop_long = city_pop %>% pivot_longer(-City, names_to = "year", values_to = "population") %>% mutate(year = as.integer(year))
city_pop_long = rbind(city_pop_long, pop_data_24)
city_trend_major = city_trend %>% filter(PAT_City %in% major_cities) %>% mutate(PAT_City = factor(PAT_City, levels = major_cities))
city_trend_major = city_trend_major %>% left_join(city_pop_long, by = c("PAT_City" = "City", "year" = "year")) %>%
mutate(patients_per_100k = total_patients / population * 100000)
ggplot(city_trend_major, aes(x = quarter, y = patients_per_100k, group = PAT_City, color = PAT_City)) +
geom_line(linewidth = 1,) +
geom_point() +
labs(title = "Flu patients per 100,000 over time by city", x = "Quarter", y = "Patients per 100,000", color = "City") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
write_csv(city_trend_major, "../texas_city_trend_major.csv")
read.csv(city_trend_major, "../texas_city_trend_major.csv")
city_trend_major = read.csv("../texas_city_trend_major.csv")
library(dplyr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(patchwork)
city_trend_major = read.csv("../texas_city_trend_major.csv")
ggplot(city_trend_major, aes(x = quarter, y = patients_per_100k, group = PAT_City, color = PAT_City)) +
geom_line(linewidth = 1,) +
geom_point() +
labs(title = "Flu patients per 100,000 over time by city", x = "Quarter", y = "Patients per 100,000", color = "City") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
View(city_trend_major)
View(city_trend_major)
second_spike = city_trend_major %>% filter(quarter == "2024Q1")
first_spike = city_trend_major %>% filter(quarter == "2022Q4")
second_spike = city_trend_major %>% filter(quarter == "2024Q1")
View(first_spike)
View(first_spike)
first_spike = city_trend_major %>% filter(quarter == "2022Q4") %>% select(PAT_city, total_patients, population, patients_per_100k)
View(first_spike)
View(first_spike)
first_spike = city_trend_major %>% filter(quarter == "2022Q4") %>% select("PAT_city", total_patients, population, patients_per_100k)
?select
ggplot(city_trend_major, aes(x = quarter, y = patients_per_100k, group = PAT_City, color = PAT_City)) +
geom_line(linewidth = 1,) +
geom_point() +
labs(title = "Flu patients per 100,000 over time by city", x = "Quarter", y = "Patients per 100,000", color = "City") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
first_spike = city_trend_major %>% filter(quarter == "2022Q4") %>% select(PAT_City, total_patients, population, patients_per_100k)
second_spike = city_trend_major %>% filter(quarter == "2024Q1") %>% select(PAT_City, total_patients, population, patients_per_100k)
first_spike = city_trend_major %>% filter(quarter == "2022Q4") %>% select(PAT_City, total_patients, population, patients_per_100k)
second_spike = city_trend_major %>% filter(quarter == "2024Q1") %>% select(PAT_City, total_patients, population, patients_per_100k)
View(first_spike)
View(first_spike)
ggplot(first_spike) + geom_line(aes(x=total_patients, y=patients_per_100k))
ggplot(first_spike) + geom_point(aes(x=total_patients, y=patients_per_100k))
ggplot(first_spike) + geom_point(aes(x=populatoin, y=patients_per_100k))
ggplot(first_spike) + geom_point(aes(x=population, y=patients_per_100k))
ggplot(first_spike) + geom_col(aes(x=PAT_City, y=patients_per_100k))
ggplot(first_spike) + geom_col(aes(x=PAT_City, y=patients_per_100k, col = PAT_City)) + labs(title = "Flu Patients per 100,000 during First Spike (2022Q4)")
ggplot(first_spike) + geom_col(aes(x=PAT_City, y=patients_per_100k, fill = PAT_City)) + labs(title = "Flu Patients per 100,000 during First Spike (2022Q4)")
colnames(city_trend_major)
city_trend_major = read.csv("../texas_city_trend_major.csv")
colnames(city_trend_major) = c("city", "year", "quarter", "total_patients", "population", "patients_per_100k")
View(city_trend_major)
knitr::opts_chunk$set(fig.height=8, fig.width=8, fig.align = "center", warning=FALSE, echo=FALSE, tidy=TRUE, tidy.opts=list(width.cutoff=60))
library(dplyr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(patchwork)
city_trend_major = read.csv("../texas_city_trend_major.csv")
colnames(city_trend_major) = c("city", "year", "quarter", "total_patients", "population", "patients_per_100k")
ggplot(city_trend_major, aes(x = quarter, y = patients_per_100k, group = city, color = city)) +
geom_line(linewidth = 1,) +
geom_point() +
labs(title = "Flu patients per 100,000 over time by city", x = "Quarter", y = "Patients per 100,000", color = "City") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
first_spike = city_trend_major %>% filter(quarter == "2022Q4") %>% select(city, total_patients, population, patients_per_100k)
second_spike = city_trend_major %>% filter(quarter == "2024Q1") %>% select(city, total_patients, population, patients_per_100k)
first_spike = city_trend_major %>% filter(quarter == "2022Q4") %>% select(city, total_patients, population, patients_per_100k)
second_spike = city_trend_major %>% filter(quarter == "2024Q1") %>% select(city, total_patients, population, patients_per_100k)
ggplot(first_spike) + geom_col(aes(x=city, y=patients_per_100k, fill = city)) + labs(title = "Flu Patients per 100,000 during First Spike (2022Q4)")
ggplot(first_spike) + geom_col(aes(x=city, y=patients_per_100k, fill = city)) + labs(title = "Flu Patients per 100,000 during First Spike (2022Q4)", x = "City", y = "Flu Patients per 100,000", fill = "City")
ggplot(first_spike) + geom_col(aes(x=city, y=patients_per_100k, fill = "skyblue", col="black")) + labs(title = "Flu Patients per 100,000 during First Spike (2022Q4)", x = "City", y = "Flu Patients per 100,000", fill = "City")
ggplot(first_spike) + geom_col(aes(x=city, y=patients_per_100k, fill = "skyblue", col="black")) + labs(title = "Flu Patients per 100,000 during First Spike (2022Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(first_spike) + geom_col(aes(x=city, y=patients_per_100k), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(first_spike) + geom_col(aes(x=city, y=patients_per_100k), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
?factor
first_spike = city_trend_major %>% filter(quarter == "2022Q4") %>% select(city, total_patients, population, patients_per_100k) %>% arrange(desc(patients_per_100k))
second_spike = city_trend_major %>% filter(quarter == "2024Q1") %>% select(city, total_patients, population, patients_per_100k)
first_spike = city_trend_major %>% filter(quarter == "2022Q4") %>% select(city, total_patients, population, patients_per_100k) %>% arrange(desc(patients_per_100k))
second_spike = city_trend_major %>% filter(quarter == "2024Q1") %>% select(city, total_patients, population, patients_per_100k)
```{r}
ggplot(first_spike) + geom_col(aes(x=city, y=patients_per_100k), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(second_spike) + geom_col(aes(x=city, y=patients_per_100k), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(second_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(first_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(second_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(first_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(second_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(first_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(second_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(first_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(second_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(first_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(second_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
# Vaccination coverage correlation
## Correlation
ggplot(first_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(second_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000")
View(second_spike)
View(second_spike)
View(first_spike)
View(first_spike)
knitr::opts_chunk$set(fig.height=8, fig.width=8, fig.align = "center", warning=FALSE, echo=FALSE, tidy=TRUE, tidy.opts=list(width.cutoff=60))
library(dplyr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(patchwork)
city_trend_major = read.csv("../texas_city_trend_major.csv")
colnames(city_trend_major) = c("city", "year", "quarter", "total_patients", "population", "patients_per_100k")
ggplot(city_trend_major, aes(x = quarter, y = patients_per_100k, group = city, color = city)) +
geom_line(linewidth = 1,) +
geom_point() +
labs(title = "Flu patients per 100,000 over time by city", x = "Quarter", y = "Patients per 100,000", color = "City") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
first_spike = city_trend_major %>% filter(quarter == "2022Q4") %>% select(city, total_patients, population, patients_per_100k)
second_spike = city_trend_major %>% filter(quarter == "2024Q1") %>% select(city, total_patients, population, patients_per_100k)
city_trend_major = read.csv("../texas_city_trend_major.csv")
colnames(city_trend_major) = c("city", "year", "quarter", "total_patients", "population", "patients_per_100k")
ggplot(city_trend_major, aes(x = quarter, y = patients_per_100k, group = city, color = city)) +
geom_line(linewidth = 1,) +
geom_point() +
labs(title = "Flu patients per 100,000 over time by city", x = "Quarter", y = "Patients per 100,000", color = "City") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
first_spike = city_trend_major %>% filter(quarter == "2022Q4") %>% select(city, total_patients, population, patients_per_100k)
second_spike = city_trend_major %>% filter(quarter == "2024Q1") %>% select(city, total_patients, population, patients_per_100k)
ggplot(first_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(second_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000")
ggplot(second_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000")
ggplot(first_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(second_spike) + geom_col(aes(x=city, y=sort(patients_per_100k)), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000")
ggplot(first_spike) + geom_col(aes(x=city, y=patients_per_100k), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(second_spike) + geom_col(aes(x=city, y=patients_per_100k), fill = "skyblue", col="black") + labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000")
ggplot(first_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
ggplot(second_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000")
first + second
library(patchwork)
first = ggplot(first_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
second = ggplot(second_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000")
first + second
first // second
first / second
first = ggplot(first_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
second = ggplot(second_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000")
first / second
first + second
first = ggplot(first_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000")
second = ggplot(second_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000")
first / second
second = ggplot(second_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000") +theme_m
second = ggplot(second_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000") + theme_minimal()
first = ggplot(first_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000") + theme_bw()
second = ggplot(second_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000") + theme_minimal()
first / secondfirst / secondtheme_minimal()
first = ggplot(first_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000") + theme_bw()
second = ggplot(second_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000") + theme_minimal()
first / second
first = ggplot(first_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000") + theme_bw()
second = ggplot(second_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000")
first / second
first = ggplot(first_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000") + theme_bw()
second = ggplot(second_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000") + theme_bw()
first / second
ggplot(city_trend_major, aes(x = quarter, y = patients_per_100k, group = city, color = city)) +
geom_line(linewidth = 1,) +
geom_point() +
labs(title = "Flu patients per 100,000 over time by city", x = "Quarter", y = "Patients per 100,000", color = "City") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) + theme_bw()
ggplot(city_trend_major %>% filter(quarter == "2022Q4" |quarter == "2024Q1") + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000") + theme_bw()
ggplot(city_trend_major %>% filter(quarter == "2022Q4" |quarter == "2024Q1")) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000") + theme_bw()
ggplot(city_trend_major %>% filter(quarter == "2022Q4" | quarter == "2024Q1")) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k, fill = quarter), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000") + theme_bw()
ggplot(city_trend_major %>% filter(quarter == "2022Q4" | quarter == "2024Q1")) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k, fill = quarter), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000") + theme_bw()
ggplot(city_trend_major %>% filter(quarter == "2022Q4" | quarter == "2024Q1")) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k, fill = quarter), col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000") + theme_bw()
?geom_col
ggplot(city_trend_major %>% filter(quarter == "2022Q4" | quarter == "2024Q1")) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k, fill = quarter), position = position_dodge2(preserve = "single"), col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000") + theme_bw()
ggplot(city_trend_major %>% filter(quarter == "2022Q4" | quarter == "2024Q1")) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k, fill = quarter), position = position_dodge2(preserve = "single"), col="black") +
labs(title = "Flu Patients per 100,000 during Spikes", x = "City", y = "Flu Patients per 100,000") + theme_bw()
ggplot(city_trend_major %>% filter(quarter == "2022Q4" | quarter == "2024Q1")) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k, fill = quarter), position = position_dodge2(preserve = "single"), col="black") +
labs(title = "Flu Patients per 100,000 during Spikes", x = "City", y = "Flu Patients per 100,000") + theme_bw()
ggplot(city_trend_major %>% filter(quarter == "2022Q4" | quarter == "2024Q1")) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k, fill = quarter), position = position_dodge2(preserve = "single"), col="black") +
labs(title = "Flu Patients per 100,000 during Spikes", x = "City", y = "Flu Patients per 100,000", color = "Quarter") + theme_bw()
ggplot(city_trend_major %>% filter(quarter == "2022Q4" | quarter == "2024Q1")) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k, fill = quarter), position = position_dodge2(preserve = "single"), col="black") +
labs(title = "Flu Patients per 100,000 during Spikes", x = "City", y = "Flu Patients per 100,000", fill = "Quarter") + theme_bw()
corresponding_cities_vax = c(
"Houston",           # Harris County
"San Antonio",       # Bexar County
"Dallas",            # Dallas County
"Austin",            # Travis County
"Fort Worth & Arlington", # Tarrant County
"El Paso",           # El Paso County
"Corpus Christi"     # Nueces County
)
texas_flu_vax = data.frame(
county = unique(counties),
corresponding_cities = corresponding_cities_vax,
coverage_rate = c(38.4, 41.4, 39.9, 42.5, 39.4, 38, 34.1)
) %>% arrange(desc(coverage_rate))
counties = c("Harris County", "Bexar County", "Dallas County", "Travis County", "Tarrant County", "El Paso County", "Tarrant County", "Nueces County")
corresponding_cities_vax = c(
"Houston",           # Harris County
"San Antonio",       # Bexar County
"Dallas",            # Dallas County
"Austin",            # Travis County
"Fort Worth & Arlington", # Tarrant County
"El Paso",           # El Paso County
"Corpus Christi"     # Nueces County
)
texas_flu_vax = data.frame(
county = unique(counties),
corresponding_cities = corresponding_cities_vax,
coverage_rate = c(38.4, 41.4, 39.9, 42.5, 39.4, 38, 34.1)
) %>% arrange(desc(coverage_rate))
knitr::kable(texas_flu_vax, caption = "Flu Vaccination Coverage Estimates by County in 2022", col.names = c("County", "Corresponding Cities", "Coverage Rate"))
write_csv(texas_flu_vax, "../texas_flu_vax.csv")
write_csv(texas_flu_vax, "../texas_flu_vax.csv")
wd
getwd()
setwd("C:\Users\advay\My Drive\UT Notes\Research\MeyersLab
setwd(C:\Users\advay\My Drive\UT Notes\Research\MeyersLab)
setwd(C:/Users/advay/My Drive/UT Notes/Research/MeyersLab)
setwd("C:/Users/advay/My Drive/UT Notes/Research/MeyersLab")
getwd()
write_csv(texas_flu_vax, "../texas_flu_vax.csv")
setwd("C:/Users/advay/My Drive/UT Notes/Research/MeyersLab")
write_csv(texas_flu_vax, "texas_flu_vax.csv")
knitr::opts_chunk$set(fig.height=8, fig.width=8, fig.align = "center", warning=FALSE, echo=FALSE, tidy=TRUE, tidy.opts=list(width.cutoff=60))
library(dplyr)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(patchwork)
city_trend_major = read.csv("../texas_city_trend_major.csv")
colnames(city_trend_major) = c("city", "year", "quarter", "total_patients", "population", "patients_per_100k")
ggplot(city_trend_major, aes(x = quarter, y = patients_per_100k, group = city, color = city)) +
geom_line(linewidth = 1,) +
geom_point() +
labs(title = "Flu patients per 100,000 over time by city", x = "Quarter", y = "Patients per 100,000", color = "City") +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) + theme_bw()
first_spike = city_trend_major %>% filter(quarter == "2022Q4") %>% select(city, total_patients, population, patients_per_100k)
second_spike = city_trend_major %>% filter(quarter == "2024Q1") %>% select(city, total_patients, population, patients_per_100k)
first = ggplot(first_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2022 Q4)", x = "City", y = "Flu Patients per 100,000") + theme_bw()
second = ggplot(second_spike) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k), fill = "skyblue", col="black") +
labs(title = "Flu Patients per 100,000 during First Spike (2024 Q1)", x = "City", y = "Flu Patients per 100,000") + theme_bw()
first / second
ggplot(city_trend_major %>% filter(quarter == "2022Q4" | quarter == "2024Q1")) + geom_col(aes(x = reorder(city, patients_per_100k), y = patients_per_100k, fill = quarter), position = position_dodge2(preserve = "single"), col="black") +
labs(title = "Flu Patients per 100,000 during Spikes", x = "City", y = "Flu Patients per 100,000", fill = "Quarter") + theme_bw()
flu_vax = read.csv("../texas_flu_vax.csv")
View(flu_vax)
View(flu_vax)
View(city_trend_major)
View(city_trend_major)
first_spike %>% left_join(city_health)
city_health = read.csv("../texas_cityhealth.csv") # 2022
flu_vax = read.csv("../texas_flu_vax.csv") # 2022
first_spike %>% left_join(city_health)
View(city_health)
View(city_health)
View(city_health)
View(city_health)
